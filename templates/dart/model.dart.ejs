/**
 * Generated by firestore-odm
 * Do not edit manually.
 */
// ignore_for_file: unused_import, unused_local_variable

import 'package:cloud_firestore/cloud_firestore.dart';
// Import other necessary packages if needed

<%# Helper function to get Dart type - defined within the template for simplicity %>
<%_
const getDartType = (field, options) => {
  switch (field.type) {
    case 'string': return 'String';
    case 'number': return 'num'; // Or double/int based on further schema info?
    case 'boolean': return 'bool';
    case 'timestamp': return 'Timestamp'; // Or DateTime if configured
    case 'geopoint': return 'GeoPoint';
    case 'reference':
      const refModelName = field.referenceTo ? camelToPascalCase(field.referenceTo) + 'Data' : 'DocumentSnapshot';
      return `DocumentReference<${refModelName}>`; // Assumes ModelData type exists
    case 'array':
      if (!field.items) return 'List<dynamic>';
      return `List<${getDartType(field.items, options)}>`;
    case 'map':
      if (!field.properties) return 'Map<String, dynamic>';
      // For maps, generate inline or reference another class? For now, dynamic map.
      return 'Map<String, dynamic>'; // TODO: Generate typed map if possible
    default: return 'dynamic';
  }
};
_%>

/// Represents the data structure for a '<%- modelName %>' document.
/// Description: <%- collection.description || 'N/A' %>
class <%- modelName %>Data {
<% Object.values(collection.fields).forEach(field => { -%>
  /// <%- field.description || field.fieldName %> (<%- field.type %><%- field.required ? ', required' : '' %>)
  final <%- getDartType(field, options) %><%- field.required ? '' : '?' %> <%- field.fieldName %>;
<% }); -%>

  const <%- modelName %>Data({
<% Object.values(collection.fields).forEach(field => { -%>
    <%- field.required ? 'required ' : '' %>this.<%- field.fieldName %>,
<% }); -%>
  });

  /// Creates a <%- modelName %>Data instance from a Firestore DocumentSnapshot.
  factory <%- modelName %>Data.fromSnapshot(DocumentSnapshot snapshot) {
    final data = snapshot.data() as Map<String, dynamic>?;
    if (data == null) {
        throw Exception("Document data was null!"); // Or handle differently
    }
    return <%- modelName %>Data(
<% Object.values(collection.fields).forEach(field => { -%>
      <%- field.fieldName %>: data['<%- field.fieldName %>'] as <%- getDartType(field, options) %><%- field.required ? '' : '?' %>, // TODO: Add type casting/parsing for complex types (Timestamp, Ref, Map, List<T>)
<% }); -%>
    );
  }

   /// Creates a <%- modelName %>Data instance from a Map.
  factory <%- modelName %>Data.fromJson(Map<String, dynamic> data) {
     return <%- modelName %>Data(
<% Object.values(collection.fields).forEach(field => { -%>
      <%- field.fieldName %>: data['<%- field.fieldName %>'] as <%- getDartType(field, options) %><%- field.required ? '' : '?' %>, // TODO: Add type casting/parsing
<% }); -%>
    );
  }

  /// Converts this <%- modelName %>Data instance to a Map suitable for Firestore.
  Map<String, dynamic> toJson() {
    return {
<% Object.values(collection.fields).forEach(field => { -%>
      '<%- field.fieldName %>': <%- field.fieldName %>, // TODO: Handle nested toJson for maps/lists/refs?
<% }); -%>
    };
  }

  /// Creates a copy of this instance with potentially modified fields.
  <%- modelName %>Data copyWith({
<% Object.values(collection.fields).forEach(field => { -%>
    <%- getDartType(field, options) %>? <%- field.fieldName %>,
<% }); -%>
  }) {
    return <%- modelName %>Data(
<% Object.values(collection.fields).forEach(field => { -%>
      <%- field.fieldName %>: <%- field.fieldName %> ?? this.<%- field.fieldName %>,
<% }); -%>
    );
  }

  // TODO: Add toString, equals, hashCode implementations?
}